<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To√°n 6: B√†i 5 - Trung ƒëi·ªÉm c·ªßa ƒëo·∫°n th·∫≥ng</title>
    
    <script>
        window.MathJax = {
            tex: { 
                inlineMath: [['$', '$'], ['\\(', '\\)']], 
                displayMath: [['$$', '$$']],
                processEscapes: true 
            },
            options: { enableMenu: false }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #0581be; 
            --accent: #f57c00; 
            --bg: #f1f8e9;
            --correct: #2e7d32;
            --wrong: #c62828;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 20px; line-height: 1.6; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
        
        /* HEADER */
        .header-wrapper {
            display: flex; align-items: center; padding: 20px; background: #0581be;
            margin: -30px -30px 30px -30px; border-radius: 20px 20px 0 0; border-bottom: 2px solid #00adef;
        }
        .logo-img { width: 80px; height: 80px; border-radius: 50%; border: 2px solid #eee; }
        .title-content { flex-grow: 1; text-align: center; }
        .title-content h1 { margin: 0; font-size: 24px; color: #0ce73c; text-transform: uppercase; }
        .title-content p { margin: 5px 0 0 0; font-style: italic; color: #cef106; }

        /* KI·∫æN TH·ª®C C·ª§ TH·ªÇ */
        .knowledge-box { background: #fffde7; border-left: 8px solid #fbc02d; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .knowledge-box h3 { margin-top: 0; color: #f57f17; }
        
        /* TH·ª∞C NGHI·ªÜM */
        .sim-container { background: #263238; color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 30px; }
        .balance-box { position: relative; height: 160px; background: white; border-radius: 10px; margin: 15px 0; overflow: hidden; }
        .line-ab { position: absolute; top: 100px; left: 100px; width: 500px; height: 4px; background: #bbb; z-index: 1; }
        .point-fixed { position: absolute; width: 12px; height: 12px; background: #333; border-radius: 50%; top: 96px; z-index: 2; transform: translateX(-50%); }
        .m-group { position: absolute; width: 40px; cursor: ew-resize; z-index: 10; transform: translateX(-50%); }
        .m-label { position: absolute; top: 65px; width: 100%; text-align: center; color: var(--accent); font-weight: bold; font-style: italic; font-size: 24px; font-family: 'Times New Roman'; }
        .m-dot { position: absolute; top: 94px; left: 50%; width: 16px; height: 16px; background: var(--accent); border-radius: 50%; border: 2px solid white; transform: translateX(-50%); box-shadow: 0 0 5px rgba(0,0,0,0.3); }

        /* QUIZ */
        .q-card { background: #f9f9f9; padding: 15px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 15px; position: relative; }
        .drop-zone { display: inline-block; width: 110px; height: 32px; border: 2px dashed var(--primary); background: #fff; vertical-align: middle; border-radius: 4px; text-align: center; line-height: 30px; font-weight: bold; color: var(--primary); }
        .drag-item { display: inline-block; padding: 4px 10px; background: #546e7a; color: white; border-radius: 4px; cursor: grab; margin: 5px; font-size: 14px; }
        .opt-btn { display: block; width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ccc; border-radius: 6px; cursor: pointer; text-align: left; background: white; transition: 0.3s; }
        .selected { background: #e3f2fd !important; border-color: var(--primary) !important; }
        
        /* Feedback colors */
        .btn-correct { background: #c8e6c9 !important; border-color: #2e7d32 !important; color: #1b5e20; font-weight: bold; }
        .btn-wrong { background: #ffcdd2 !important; border-color: #c62828 !important; color: #b71c1c; }
        .feedback-text { font-size: 0.9rem; margin-top: 8px; font-weight: bold; display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-wrapper">
        <img src="https://lh3.googleusercontent.com/u/0/d/1pvgGXoH3PeMQsKQz1SN7R02gTudoNvHR" alt="Logo" class="logo-img">
        <div class="title-content">
            <h1>üìç B√ÄI 5: TRUNG ƒêI·ªÇM C·ª¶A ƒêO·∫†N TH·∫≤NG</h1>
            <p>Ng∆∞·ªùi bi√™n so·∫°n: Ph·∫°m Th·ªã Xu√¢n</p>
        </div>
    </div>

    <section>
        <h2 style="color:var(--primary);">1. Ki·∫øn th·ª©c c·∫ßn nh·ªõ</h2>
        <div class="knowledge-box">
            <h3>ƒê·ªãnh nghƒ©a</h3>
            <p>ƒêi·ªÉm $M$ ƒë∆∞·ª£c g·ªçi l√† <b>trung ƒëi·ªÉm</b> c·ªßa ƒëo·∫°n th·∫≥ng $AB$ khi v√† ch·ªâ khi ƒëi·ªÉm $M$ th·ªèa m√£n ƒë·ªìng th·ªùi hai ƒëi·ªÅu ki·ªán:</p>
            <ul>
                <li><b>N·∫±m gi·ªØa:</b> ƒêi·ªÉm $M$ ph·∫£i thu·ªôc ƒëo·∫°n th·∫≥ng $AB$ ($M$ n·∫±m gi·ªØa $A$ v√† $B$).</li>
                <li><b>C√°ch ƒë·ªÅu:</b> Kho·∫£ng c√°ch t·ª´ $M$ ƒë·∫øn hai ƒë·∫ßu m√∫t b·∫±ng nhau ($MA = MB$).</li>
            </ul>
            <p>üëâ H·ªá th·ª©c to√°n h·ªçc: $MA = MB = \frac{AB}{2}$</p>
        </div>
    </section>

    <section>
        <h2 style="color:var(--primary);">2. Th·ª±c h√†nh ƒëo ƒë·∫°c</h2>
        <div class="sim-container">
            <p>Cho ƒëo·∫°n th·∫≥ng $AB = 10 \text{ cm}$. H√£y di chuy·ªÉn ƒëi·ªÉm $M$ ƒë·∫øn ƒë√∫ng v·ªã tr√≠ trung ƒëi·ªÉm.</p>
            <div class="balance-box" id="sim-area">
                <div class="line-ab"></div>
                <div class="point-fixed" style="left:100px;"></div>
                <div style="position:absolute; top:115px; left:100px; color:#333; font-weight:bold; transform:translateX(-50%);">A</div>
                <div class="point-fixed" style="left:600px;"></div>
                <div style="position:absolute; top:115px; left:600px; color:#333; font-weight:bold; transform:translateX(-50%);">B</div>
                <div id="m-group" class="m-group" style="left: 200px;">
                    <div class="m-label">M</div>
                    <div class="m-dot"></div>
                </div>
            </div>
            <div id="dist-display" style="font-size:1.3rem; font-weight:bold; color:#ffeb3b; font-family: monospace;">MA = 2.0 cm | MB = 8.0 cm</div>
            <div id="status-msg" style="height:25px; color:#0ce73c; font-weight:bold; margin-top:5px;"></div>
        </div>
    </section>

    <section id="quiz-auth" style="text-align:center;">
        <h2 style="color:var(--primary);">3. B√†i t·∫≠p v·∫≠n d·ª•ng (10 c√¢u)</h2>
        <input type="text" id="userName" placeholder="Nh·∫≠p t√™n em..." style="padding:10px; border-radius:5px; border:1px solid #ccc;">
        <button onclick="startQuiz()" style="padding:10px 20px; background:var(--primary); color:white; border:none; border-radius:5px; cursor:pointer;">B·∫ÆT ƒê·∫¶U L√ÄM B√ÄI</button>
    </section>

    <div id="quiz-area" style="display:none; margin-top:20px;">
        <div style="background:#37474f; color:white; padding:10px; border-radius:8px; display:flex; justify-content:space-between; margin-bottom:20px;">
            <span id="name-tag"></span>
            <span>‚è± C√≤n l·∫°i: <b id="timer" style="color:#ffeb3b;">10:00</b></span>
        </div>

        <div class="q-card" id="q1">
            <b>C√¢u 1:</b> Trung ƒëi·ªÉm c·ªßa ƒëo·∫°n th·∫≥ng $PQ$ l√† ƒëi·ªÉm <div class="drop-zone" id="dz1">?</div> $P, Q$ v√† c√°ch ƒë·ªÅu $P, Q$.
            <div style="margin-top:10px;">
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="dr1" data-val="n·∫±m gi·ªØa">n·∫±m gi·ªØa</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="dr2" data-val="n·∫±m ngo√†i">n·∫±m ngo√†i</div>
            </div>
            <div class="feedback-text" id="fb1"></div>
        </div>

        <div class="q-card" id="q2">
            <b>C√¢u 2:</b> N·∫øu $I$ l√† trung ƒëi·ªÉm c·ªßa ƒëo·∫°n th·∫≥ng $EF = 8 \text{ cm}$ th√¨ $IE = $ <div class="drop-zone" id="dz2">?</div>.
            <div style="margin-top:10px;">
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="dr3" data-val="4 cm">4 cm</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="dr4" data-val="8 cm">8 cm</div>
            </div>
            <div class="feedback-text" id="fb2"></div>
        </div>

        <div id="mcq-container"></div>

        <button onclick="checkResults()" id="submit-btn" style="display:block; margin:20px auto; padding:12px 40px; background:var(--accent); color:white; border:none; border-radius:25px; font-weight:bold; cursor:pointer;">N·ªòP B√ÄI</button>
        <div id="score-board" style="text-align:center; font-size:1.8rem; color:var(--primary); padding-bottom:50px; font-weight: bold;"></div>
    </div>
</div>

<script>
    // X·ª¨ L√ù TH·ª∞C NGHI·ªÜM
    const mGroup = document.getElementById('m-group');
    const distDisplay = document.getElementById('dist-display');
    const statusMsg = document.getElementById('status-msg');
    let isMoving = false;

    mGroup.onmousedown = () => isMoving = true;
    document.onmouseup = () => isMoving = false;
    document.onmousemove = (e) => {
        if (!isMoving) return;
        let rect = document.getElementById('sim-area').getBoundingClientRect();
        let x = e.clientX - rect.left;
        if (x >= 100 && x <= 600) {
            mGroup.style.left = x + 'px';
            let ma = ((x - 100) / 50).toFixed(1);
            let mb = ((600 - x) / 50).toFixed(1);
            distDisplay.innerText = `MA = ${ma} cm | MB = ${mb} cm`;
            if (ma === mb) {
                statusMsg.innerText = "üåü Tuy·ªát v·ªùi! M l√† trung ƒëi·ªÉm AB.";
                distDisplay.style.color = "#0ce73c";
            } else {
                statusMsg.innerText = "";
                distDisplay.style.color = "#ffeb3b";
            }
        }
    };

    // D·ªÆ LI·ªÜU MCQ
    const questions = [
        { q: "M·ªói ƒëo·∫°n th·∫≥ng c√≥ bao nhi√™u trung ƒëi·ªÉm?", a: ["V√¥ s·ªë", "2", "1"], c: 2 },
        { q: "N·∫øu $M$ l√† trung ƒëi·ªÉm c·ªßa $AB$ th√¨ h·ªá th·ª©c n√†o sau ƒë√¢y ƒë√∫ng?", a: ["$MA = MB$", "$MA + MB = AB$", "C·∫£ hai c√¢u tr√™n ƒë·ªÅu ƒë√∫ng"], c: 2 },
        { q: "ƒêi·ªÉm ch√≠nh gi·ªØa c·ªßa m·ªôt ƒëo·∫°n th·∫≥ng c√≤n ƒë∆∞·ª£c g·ªçi l√† g√¨?", a: ["Giao ƒëi·ªÉm", "Trung ƒëi·ªÉm", "ƒê·∫ßu m√∫t"], c: 1 },
        { q: "Cho $I$ l√† trung ƒëi·ªÉm $AB = 10\\text{ cm}$. T√≠nh ƒë·ªô d√†i $IA$?", a: ["5 cm", "10 cm", "2.5 cm"], c: 0 },
        { q: "N·∫øu $IA = IB = 3 \\text{cm}$ v√† $I, A, B$ th·∫≥ng h√†ng th√¨ ƒë·ªô d√†i $AB$ l√†:", a: ["3 cm", "6 cm", "9 cm"], c: 1 },
        { q: "Tr√™n tia $Ox$ l·∫•y $OA = 3 \\text{ cm}$, $OB = 6 \\text{ cm}$. Kh·∫≥ng ƒë·ªãnh n√†o ƒë√∫ng?", a: ["O l√† trung ƒëi·ªÉm AB", "A l√† trung ƒëi·ªÉm OB", "B l√† trung ƒëi·ªÉm OA"], c: 1 },
        { q: "ƒê·ªÉ $M$ l√† trung ƒëi·ªÉm c·ªßa $CD$ th√¨ $M$ ph·∫£i thu·ªôc ƒëo·∫°n th·∫≥ng $CD$ v√†:", a: ["$MC = MD$", "$MC < MD$", "$MC > MD$"], c: 0 },
        { q: "V·∫°ch s·ªë 0 v√† v·∫°ch s·ªë 10 tr√™n th∆∞·ªõc k·∫ª. Trung ƒëi·ªÉm l√† v·∫°ch s·ªë m·∫•y?", a: ["V·∫°ch s·ªë 4", "V·∫°ch s·ªë 5", "V·∫°ch s·ªë 6"], c: 1 }
    ];

    let userMCQ = Array(8).fill(null);

    function startQuiz() {
        if (!document.getElementById('userName').value) return alert("Em nh·∫≠p t√™n tr∆∞·ªõc nh√©!");
        document.getElementById('name-tag').innerText = "H·ªçc sinh: " + document.getElementById('userName').value;
        document.getElementById('quiz-auth').style.display = 'none';
        document.getElementById('quiz-area').style.display = 'block';
        
        let html = "";
        questions.forEach((item, i) => {
            html += `<div class="q-card" id="mcq-q${i}"><b>C√¢u ${i+3}:</b> ${item.q}<br>`;
            item.a.forEach((opt, idx) => {
                html += `<button class="opt-btn mcq-${i}" id="btn-${i}-${idx}" onclick="pickMCQ(${i}, ${idx}, this)">${opt}</button>`;
            });
            html += `<div class="feedback-text" id="fb-mcq${i}"></div></div>`;
        });
        document.getElementById('mcq-container').innerHTML = html;
        if (window.MathJax) MathJax.typesetPromise();
        startTimer(600);
    }

    function pickMCQ(q, o, btn) {
        userMCQ[q] = o;
        document.querySelectorAll(`.mcq-${q}`).forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
    }

    function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); }
    function allowDrop(ev) { ev.preventDefault(); }
    document.querySelectorAll('.drop-zone').forEach(dz => {
        dz.ondragover = allowDrop;
        dz.ondrop = function(ev) {
            ev.preventDefault();
            let data = ev.dataTransfer.getData("text");
            let el = document.getElementById(data);
            this.innerText = el.innerText;
            this.setAttribute("data-ans", el.getAttribute("data-val"));
        }
    });

    let timer;
    function startTimer(s) {
        timer = setInterval(() => {
            let m = Math.floor(s/60), sec = s%60;
            document.getElementById('timer').innerText = `${m}:${sec<10?'0'+sec:sec}`;
            if(--s < 0) checkResults();
        }, 1000);
    }

    function checkResults() {
        clearInterval(timer);
        let score = 0;
        
        // Check Drag Drop Q1
        const dz1 = document.getElementById('dz1');
        const fb1 = document.getElementById('fb1');
        if (dz1.getAttribute("data-ans") === "n·∫±m gi·ªØa") {
            score++;
            dz1.style.color = "var(--correct)";
            fb1.innerHTML = "‚úÖ ƒê√∫ng r·ªìi!";
        } else {
            dz1.style.color = "var(--wrong)";
            fb1.innerHTML = "‚ùå Sai r·ªìi. ƒê√°p √°n ƒë√∫ng l√†: <b>n·∫±m gi·ªØa</b>";
        }
        fb1.style.display = "block";

        // Check Drag Drop Q2
        const dz2 = document.getElementById('dz2');
        const fb2 = document.getElementById('fb2');
        if (dz2.getAttribute("data-ans") === "4 cm") {
            score++;
            dz2.style.color = "var(--correct)";
            fb2.innerHTML = "‚úÖ Ch√≠nh x√°c!";
        } else {
            dz2.style.color = "var(--wrong)";
            fb2.innerHTML = "‚ùå Sai r·ªìi. ƒê√°p √°n ƒë√∫ng l√†: <b>4 cm</b>";
        }
        fb2.style.display = "block";

        // Check MCQ
        questions.forEach((item, i) => {
            const fbMcq = document.getElementById(`fb-mcq${i}`);
            const correctIdx = item.c;
            const userIdx = userMCQ[i];

            // Highlight ƒë√∫ng/sai
            document.querySelectorAll(`.mcq-${i}`).forEach((btn, idx) => {
                btn.disabled = true; // Kh√≥a n√∫t sau khi n·ªôp
                if (idx === correctIdx) btn.classList.add('btn-correct');
                if (idx === userIdx && userIdx !== correctIdx) btn.classList.add('btn-wrong');
            });

            if (userIdx === correctIdx) {
                score++;
                fbMcq.innerHTML = "‚úÖ ƒê√∫ng";
                fbMcq.style.color = "var(--correct)";
            } else {
                fbMcq.innerHTML = `‚ùå Sai. ƒê√°p √°n ƒë√∫ng l√†: ${item.a[correctIdx]}`;
                fbMcq.style.color = "var(--wrong)";
            }
            fbMcq.style.display = "block";
        });

        document.getElementById('score-board').innerHTML = `K·∫æT QU·∫¢: ${score} / 10`;
        document.getElementById('submit-btn').style.display = 'none';
        window.scrollTo(0, document.body.scrollHeight);
    }
</script>
</body>
</html>
